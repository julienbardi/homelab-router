<hash> docs/security-model.md

<hash> Security and Trust Model

This document describes the security assumptions and trust boundaries of the
homelab router and WireGuard control plane.

It explains what is trusted, what is not, and where responsibility is
intentionally placed.

---

<hash> Threat Model

This system assumes:

- The LAN is trusted
- The router and NAS are physically controlled
- VPN clients may be untrusted or compromised
- The Internet is hostile

The goal is containment, not absolute prevention.

---

<hash> Trust Boundaries

The system defines explicit trust boundaries:

- Control plane (domain.yaml, docs) is trusted
- Execution plane scripts are trusted
- VPN clients are not trusted
- Public endpoints are not trusted

Trust does not cross boundaries implicitly.

---

<hash> Router Trust Model

The router is trusted to:

- Execute scripts faithfully
- Enforce firewall and routing rules
- Terminate WireGuard tunnels
- Protect private keys stored on JFFS

The router is not trusted to:

- Store authoritative intent
- Be the sole copy of configuration
- Survive without recovery procedures

---

<hash> NAS Trust Model

The NAS is trusted to:

- Store authoritative domain intent
- Store generated artifacts
- Provide stable storage and backups
- Host benchmark WireGuard servers

The NAS is not trusted to:

- Route production traffic
- Enforce security policy
- Act as a public endpoint

---

<hash> VPN Client Trust Model

VPN clients are assumed to be:

- Potentially compromised
- Mobile and transient
- Outside administrative control

As a result:

- Clients receive minimal AllowedIPs
- Server-side AllowedIPs are restrictive
- No client is trusted with routing authority
- Profiles limit blast radius

---

<hash> Key Management

- Private keys are generated by scripts
- Keys are never committed to Git
- Server keys live only on execution nodes
- Client keys are distributed explicitly

Key rotation is supported by regeneration, not mutation.

---

<hash> Network Exposure

- Only WireGuard ports are exposed publicly
- Management access is LAN-only
- No service is exposed without explicit intent
- Benchmark interfaces do not route Internet traffic

---

<hash> Failure and Compromise

In case of suspected compromise:

- Revoke client keys
- Regenerate server keys
- Re-deploy from authoritative intent
- Validate invariants via preflight checks

Recovery is procedural, not ad-hoc.

---

<hash> Summary

Security in this system is achieved by:

- Explicit trust boundaries
- Minimal privilege
- Declarative intent
- Deterministic recovery

Anything not explicitly trusted is treated as hostile.
